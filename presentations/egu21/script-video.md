# Script for video

Hello everyone! Thanks for joining me today.

My name is Santiago Soler, PhD Student in Geophysics from Argentina and one of
the core developers of the Fatiando a Terra project.
My research is focused on new methodologies for processing, forward and inverse
modelling gravity and magnetic data.

Today I want to present you the Gradient-boosted equivalent sources: a method
for interpolating large gravity and magnetic datasets through the equivalent
sources technique, developed by Leonardo Uieda and myself.

The equivalent sources technique is an interpolation method for harmonic data.
It consists in:
1. defining a set of sources placed beneath the observation points,
2. estimate their coefficients so they generate the same observed field,
3. and compute the field generated by the sources on any other set of points,
   like a regular grid

This technique has two advantages:
- it generates harmonic fields,
- it takes into account the elevation of the observation points

Its main drawback is that it requires a large amount of memory.
Let me picture this problem with an example.
Consider a set of data points and a set of sources locate beneath each one of
them.
When we need to estimate the source coefficients, we need to solve this linear
problem: data equals to a Jacobian matrix A times the vector of source
coefficients.
If we are working with too many data points and sources, this matrix A might be
too large to fit in memory.

For example, to interpolate a dataset of 2 hundred thousand points, we would
need 3 hundred gigabytes of RAM.

We developed the gradient-boosted equivalent sources as a solution to this
problem.
It consists in:
1. dividing the survey area in overlapping windows of equal size.
2. create one set of equivalent sources per window
3. now the data can be reproduced as the sum of the field generated by each set
   of equivalent sources.

So the vector containing the data can be equal to the sum over each set of
a step-size coefficient times a smaller Jacobian matrix times the coefficients
vector of the current set.
Notice that we have introduced a new parameter: the step-size coefficient.
It will play an important role on the fitting process.

How do we estimate the coefficients of these new gradient-boosted equivalent
sources?

Let's start with the same example data and sources.

On the first iteration we select the data and sources that fall under the first
window and estimate their coefficients by solving a simple linear problem.
Then we predict the field generated by these sources on every point and
estimate the step-size coefficient for that window.
This is done by minimizing the difference between the original data and the
step-size coefficient times the field generated by the first set of sources.
This step helps our algorithm convergence by incorporating in some extent the
effect of every data point outside the current window.
Finally we compute the residuals as the difference between the data and the
field generated by this set of sources times the step-size coefficient.


On the next iteration, we would select the residuals and the sources that fall
under the next window, fit their coefficients, estimate the step-size
coefficient and finally predict the field on every point
and update the residuals.

This process is carried out iteratively through every window.

We tested our new method against synthetic datasets and arrived to the
following conclusions:
1. The gradient-boosted equivalent sources heavily reduce the memory need to
   interpolate large gravity and magnetic datasets
2. We can control the memory usage by changing the size of the windows.
3. Although we found that the best performance is achieved by choosing the
   maximum window size that fits into memory.
4. The introduction of the step-size coefficient helps to increase the
   convergence of the method.
5. We found better performance when the order of the windows is randomized.

Using gradient-boosted equivalent sources we managed to interpolate a ground
gravity dataset from Australia containing more than 1.7 million data points
using less than 10GB of RAM.
Here you can see the original data on the left and the interpolated grid on the
right with a resolution of 1 arc-minute.

Here you can see a section of the original data and the same section of the
interpolated grid.

If you want to read more about our work, please read the preprint on
EarthArXiV, which is currently under peer-review process in Geophysical Journal
International.

You can also find out more about our work in the Computer-Oriented Geoscience
Lab or visit my personal website.

If you want to contact me, please don't hesitate to write me to
santiago.r.soler@gmail.com

Thank you!
